/*
 * Bandwidth
 *
 * Bandwidth's Communication APIs
 *
 * The version of the OpenAPI document: 1.0.0
 * Contact: letstalk@bandwidth.com
 * Generated by: https://github.com/openapitools/openapi-generator.git
 */

using System;
using System.IO;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.Linq;
using System.Reflection;
using RestSharp;
using Xunit;

using Bandwidth.Standard.Client;
using Bandwidth.Standard.Api;
using Bandwidth.Standard.Model;
using Moq;
using System.Net;

namespace Bandwidth.Standard.Test.Unit.Api
{
    /// <summary>
    ///  Class for testing EndpointsApi
    /// </summary>
    public class EndpointsApiTests : IDisposable
    {
        private EndpointsApi instance;
        private Mock<ISynchronousClient> mockClient;
        private Mock<IAsynchronousClient> mockAsynchronousClient;
        private Configuration fakeConfiguration;

        public EndpointsApiTests()
        {
            mockClient = new Mock<ISynchronousClient>();
            mockAsynchronousClient = new Mock<IAsynchronousClient>();
            fakeConfiguration = new Configuration();
            fakeConfiguration.BasePath = "https://voice.bandwidth.com/api/v2";
            fakeConfiguration.Username = "username";
            fakeConfiguration.Password = "password";
            instance = new EndpointsApi(mockClient.Object, mockAsynchronousClient.Object, fakeConfiguration);
        }

        public void Dispose()
        {
            // Cleanup when everything is done.
        }

        /// <summary>
        /// Test an instance of EndpointsApi
        /// </summary>
        [Fact]
        public void InstanceTest()
        {
            Assert.IsType<EndpointsApi>(instance);
        }

        /// <summary>
        /// Test CreateEndpoint
        /// </summary>
        [Fact]
        public void CreateEndpointTest()
        {
            string accountId = "9900000";
            DateTime creationTime = new DateTime(2021, 1, 1, 0, 0, 0, DateTimeKind.Utc);
            DateTime expirationTime = new DateTime(2021, 1, 2, 0, 0, 0, DateTimeKind.Utc);

            CreateWebRtcConnectionRequest webRtcRequest = new CreateWebRtcConnectionRequest(
                type: EndpointTypeEnum.WEBRTC,
                direction: EndpointDirectionEnum.OUTBOUND,
                tag: "test-endpoint"
            );
            CreateEndpointRequest createEndpointRequest = new CreateEndpointRequest(webRtcRequest);

            CreateEndpointResponseData responseData = new CreateEndpointResponseData(
                endpointId: "e-15ac29a2-1331029c-2cb0-4a07-b215-b22865662d85",
                type: EndpointTypeEnum.WEBRTC,
                status: EndpointStatusEnum.CONNECTED,
                creationTimestamp: creationTime,
                expirationTimestamp: expirationTime,
                token: "test-token-abc123"
            );

            CreateEndpointResponse endpointResponse = new CreateEndpointResponse(
                links: new List<Link>(),
                data: responseData,
                errors: new List<Error>()
            );

            var apiResponse = new ApiResponse<CreateEndpointResponse>(HttpStatusCode.Created, endpointResponse);
            mockClient.Setup(x => x.Post<CreateEndpointResponse>("/accounts/{accountId}/endpoints", It.IsAny<RequestOptions>(), fakeConfiguration)).Returns(apiResponse);
            var response = instance.CreateEndpointWithHttpInfo(accountId, createEndpointRequest);

            Assert.IsType<ApiResponse<CreateEndpointResponse>>(response);
            Assert.Equal(HttpStatusCode.Created, response.StatusCode);
            Assert.NotNull(response.Data);
            Assert.NotNull(response.Data.Data);
            Assert.Equal("e-15ac29a2-1331029c-2cb0-4a07-b215-b22865662d85", response.Data.Data.EndpointId);
            Assert.Equal("test-token-abc123", response.Data.Data.Token);
        }

        /// <summary>
        /// Test failed CreateEndpoint Request
        /// </summary>
        [Fact]
        public void CreateEndpointBadRequest()
        {
            string accountId = "9900000";
            CreateWebRtcConnectionRequest webRtcRequest = new CreateWebRtcConnectionRequest(
                type: EndpointTypeEnum.WEBRTC,
                direction: EndpointDirectionEnum.OUTBOUND,
                tag: "invalid-tag-with-too-many-characters-that-exceeds-maximum-length-allowed"
            );
            CreateEndpointRequest createEndpointRequest = new CreateEndpointRequest(webRtcRequest);

            var apiResponse = new ApiResponse<CreateEndpointResponse>(HttpStatusCode.BadRequest, null);
            mockClient.Setup(x => x.Post<CreateEndpointResponse>("/accounts/{accountId}/endpoints", It.IsAny<RequestOptions>(), fakeConfiguration)).Returns(apiResponse);
            ApiException Exception = Assert.Throws<ApiException>(() => instance.CreateEndpoint(accountId, createEndpointRequest));

            Assert.Equal("Error calling CreateEndpoint: ", Exception.Message);
            Assert.Equal(400, Exception.ErrorCode);
        }

        /// <summary>
        /// Test unauthorized CreateEndpoint Request
        /// </summary>
        [Fact]
        public void CreateEndpointUnauthorizedRequest()
        {
            string accountId = "9900000";
            CreateWebRtcConnectionRequest webRtcRequest = new CreateWebRtcConnectionRequest(
                type: EndpointTypeEnum.WEBRTC,
                direction: EndpointDirectionEnum.OUTBOUND,
                tag: "test-endpoint"
            );
            CreateEndpointRequest createEndpointRequest = new CreateEndpointRequest(webRtcRequest);
            fakeConfiguration.Username = "badUsername";
            fakeConfiguration.Password = "badPassword";

            var apiResponse = new ApiResponse<CreateEndpointResponse>(HttpStatusCode.Unauthorized, null);
            mockClient.Setup(x => x.Post<CreateEndpointResponse>("/accounts/{accountId}/endpoints", It.IsAny<RequestOptions>(), fakeConfiguration)).Returns(apiResponse);
            ApiException Exception = Assert.Throws<ApiException>(() => instance.CreateEndpoint(accountId, createEndpointRequest));

            Assert.Equal("Error calling CreateEndpoint: ", Exception.Message);
            Assert.Equal(401, Exception.ErrorCode);
        }

        /// <summary>
        /// Test forbidden CreateEndpoint Request
        /// </summary>
        [Fact]
        public void CreateEndpointForbiddenRequest()
        {
            string accountId = "9900000";
            CreateWebRtcConnectionRequest webRtcRequest = new CreateWebRtcConnectionRequest(
                type: EndpointTypeEnum.WEBRTC,
                direction: EndpointDirectionEnum.OUTBOUND,
                tag: "test-endpoint"
            );
            CreateEndpointRequest createEndpointRequest = new CreateEndpointRequest(webRtcRequest);
            fakeConfiguration.Username = "forbiddenUsername";
            fakeConfiguration.Password = "forbiddenPassword";

            var apiResponse = new ApiResponse<CreateEndpointResponse>(HttpStatusCode.Forbidden, null);
            mockClient.Setup(x => x.Post<CreateEndpointResponse>("/accounts/{accountId}/endpoints", It.IsAny<RequestOptions>(), fakeConfiguration)).Returns(apiResponse);
            ApiException Exception = Assert.Throws<ApiException>(() => instance.CreateEndpoint(accountId, createEndpointRequest));

            Assert.Equal("Error calling CreateEndpoint: ", Exception.Message);
            Assert.Equal(403, Exception.ErrorCode);
        }

        /// <summary>
        /// Test GetEndpoint
        /// </summary>
        [Fact]
        public void GetEndpointTest()
        {
            string accountId = "9900000";
            string endpointId = "e-15ac29a2-1331029c-2cb0-4a07-b215-b22865662d85";
            DateTime creationTime = new DateTime(2021, 1, 1, 0, 0, 0, DateTimeKind.Utc);
            DateTime expirationTime = new DateTime(2021, 1, 2, 0, 0, 0, DateTimeKind.Utc);

            Endpoint endpointData = new Endpoint(
                endpointId: endpointId,
                type: EndpointTypeEnum.WEBRTC,
                status: EndpointStatusEnum.CONNECTED,
                creationTimestamp: creationTime,
                expirationTimestamp: expirationTime,
                tag: "test-endpoint"
            );

            EndpointResponse endpointResponse = new EndpointResponse(
                links: new List<Link>(),
                data: endpointData,
                errors: new List<Error>()
            );

            var apiResponse = new ApiResponse<EndpointResponse>(HttpStatusCode.OK, endpointResponse);
            mockClient.Setup(x => x.Get<EndpointResponse>("/accounts/{accountId}/endpoints/{endpointId}", It.IsAny<RequestOptions>(), fakeConfiguration)).Returns(apiResponse);
            var response = instance.GetEndpointWithHttpInfo(accountId, endpointId);

            Assert.IsType<ApiResponse<EndpointResponse>>(response);
            Assert.Equal(HttpStatusCode.OK, response.StatusCode);
            Assert.NotNull(response.Data);
            Assert.NotNull(response.Data.Data);
            Assert.Equal(endpointId, response.Data.Data.EndpointId);
            Assert.Equal("test-endpoint", response.Data.Data.Tag);
        }

        /// <summary>
        /// Test unauthorized GetEndpoint Request
        /// </summary>
        [Fact]
        public void GetEndpointUnauthorizedRequest()
        {
            string accountId = "9900000";
            string endpointId = "e-15ac29a2-1331029c-2cb0-4a07-b215-b22865662d85";
            fakeConfiguration.Username = "badUsername";
            fakeConfiguration.Password = "badPassword";

            var apiResponse = new ApiResponse<EndpointResponse>(HttpStatusCode.Unauthorized, null);
            mockClient.Setup(x => x.Get<EndpointResponse>("/accounts/{accountId}/endpoints/{endpointId}", It.IsAny<RequestOptions>(), fakeConfiguration)).Returns(apiResponse);
            ApiException Exception = Assert.Throws<ApiException>(() => instance.GetEndpoint(accountId, endpointId));

            Assert.Equal("Error calling GetEndpoint: ", Exception.Message);
            Assert.Equal(401, Exception.ErrorCode);
        }

        /// <summary>
        /// Test forbidden GetEndpoint Request
        /// </summary>
        [Fact]
        public void GetEndpointForbiddenRequest()
        {
            string accountId = "9900000";
            string endpointId = "e-15ac29a2-1331029c-2cb0-4a07-b215-b22865662d85";
            fakeConfiguration.Username = "forbiddenUsername";
            fakeConfiguration.Password = "forbiddenPassword";

            var apiResponse = new ApiResponse<EndpointResponse>(HttpStatusCode.Forbidden, null);
            mockClient.Setup(x => x.Get<EndpointResponse>("/accounts/{accountId}/endpoints/{endpointId}", It.IsAny<RequestOptions>(), fakeConfiguration)).Returns(apiResponse);
            ApiException Exception = Assert.Throws<ApiException>(() => instance.GetEndpoint(accountId, endpointId));

            Assert.Equal("Error calling GetEndpoint: ", Exception.Message);
            Assert.Equal(403, Exception.ErrorCode);
        }

        /// <summary>
        /// Test not found GetEndpoint Request
        /// </summary>
        [Fact]
        public void GetEndpointNotFoundRequest()
        {
            string accountId = "9900000";
            string endpointId = "not-a-valid-endpoint-id";

            var apiResponse = new ApiResponse<EndpointResponse>(HttpStatusCode.NotFound, null);
            mockClient.Setup(x => x.Get<EndpointResponse>("/accounts/{accountId}/endpoints/{endpointId}", It.IsAny<RequestOptions>(), fakeConfiguration)).Returns(apiResponse);
            ApiException Exception = Assert.Throws<ApiException>(() => instance.GetEndpoint(accountId, endpointId));

            Assert.Equal("Error calling GetEndpoint: ", Exception.Message);
            Assert.Equal(404, Exception.ErrorCode);
        }

        /// <summary>
        /// Test ListEndpoints
        /// </summary>
        [Fact]
        public void ListEndpointsTest()
        {
            string accountId = "9900000";
            DateTime creationTime = new DateTime(2021, 1, 1, 0, 0, 0, DateTimeKind.Utc);
            DateTime expirationTime = new DateTime(2021, 1, 2, 0, 0, 0, DateTimeKind.Utc);

            Endpoints endpoint1 = new Endpoints(
                endpointId: "e-15ac29a2-1331029c-2cb0-4a07-b215-b22865662d85",
                type: EndpointTypeEnum.WEBRTC,
                status: EndpointStatusEnum.CONNECTED,
                creationTimestamp: creationTime,
                expirationTimestamp: expirationTime,
                tag: "endpoint-1"
            );

            Endpoints endpoint2 = new Endpoints(
                endpointId: "e-25ac29a2-2331029c-3cb0-5a07-c225-c32875772d95",
                type: EndpointTypeEnum.WEBRTC,
                status: EndpointStatusEnum.DISCONNECTED,
                creationTimestamp: creationTime,
                expirationTimestamp: expirationTime,
                tag: "endpoint-2"
            );

            ListEndpointsResponse listResponse = new ListEndpointsResponse(
                links: new List<Link>(),
                data: new List<Endpoints> { endpoint1, endpoint2 },
                errors: new List<Error>()
            );

            var apiResponse = new ApiResponse<ListEndpointsResponse>(HttpStatusCode.OK, listResponse);
            mockClient.Setup(x => x.Get<ListEndpointsResponse>("/accounts/{accountId}/endpoints", It.IsAny<RequestOptions>(), fakeConfiguration)).Returns(apiResponse);
            var response = instance.ListEndpointsWithHttpInfo(accountId);

            Assert.IsType<ApiResponse<ListEndpointsResponse>>(response);
            Assert.Equal(HttpStatusCode.OK, response.StatusCode);
            Assert.NotNull(response.Data);
            Assert.NotNull(response.Data.Data);
            Assert.Equal(2, response.Data.Data.Count);
            Assert.Equal("endpoint-1", response.Data.Data[0].Tag);
            Assert.Equal("endpoint-2", response.Data.Data[1].Tag);
        }

        /// <summary>
        /// Test ListEndpoints with type filter
        /// </summary>
        [Fact]
        public void ListEndpointsWithTypeFilterTest()
        {
            string accountId = "9900000";
            DateTime creationTime = new DateTime(2021, 1, 1, 0, 0, 0, DateTimeKind.Utc);
            DateTime expirationTime = new DateTime(2021, 1, 2, 0, 0, 0, DateTimeKind.Utc);

            Endpoints endpoint1 = new Endpoints(
                endpointId: "e-15ac29a2-1331029c-2cb0-4a07-b215-b22865662d85",
                type: EndpointTypeEnum.WEBRTC,
                status: EndpointStatusEnum.CONNECTED,
                creationTimestamp: creationTime,
                expirationTimestamp: expirationTime
            );

            ListEndpointsResponse listResponse = new ListEndpointsResponse(
                links: new List<Link>(),
                data: new List<Endpoints> { endpoint1 },
                errors: new List<Error>()
            );

            var apiResponse = new ApiResponse<ListEndpointsResponse>(HttpStatusCode.OK, listResponse);
            mockClient.Setup(x => x.Get<ListEndpointsResponse>("/accounts/{accountId}/endpoints", It.IsAny<RequestOptions>(), fakeConfiguration)).Returns(apiResponse);
            var response = instance.ListEndpointsWithHttpInfo(accountId, type: EndpointTypeEnum.WEBRTC);

            Assert.IsType<ApiResponse<ListEndpointsResponse>>(response);
            Assert.Equal(HttpStatusCode.OK, response.StatusCode);
            Assert.NotNull(response.Data.Data);
            Assert.Single(response.Data.Data);
            Assert.Equal(EndpointTypeEnum.WEBRTC, response.Data.Data[0].Type);
        }

        /// <summary>
        /// Test ListEndpoints with status filter
        /// </summary>
        [Fact]
        public void ListEndpointsWithStatusFilterTest()
        {
            string accountId = "9900000";
            DateTime creationTime = new DateTime(2021, 1, 1, 0, 0, 0, DateTimeKind.Utc);
            DateTime expirationTime = new DateTime(2021, 1, 2, 0, 0, 0, DateTimeKind.Utc);

            Endpoints endpoint1 = new Endpoints(
                endpointId: "e-15ac29a2-1331029c-2cb0-4a07-b215-b22865662d85",
                type: EndpointTypeEnum.WEBRTC,
                status: EndpointStatusEnum.CONNECTED,
                creationTimestamp: creationTime,
                expirationTimestamp: expirationTime
            );

            ListEndpointsResponse listResponse = new ListEndpointsResponse(
                links: new List<Link>(),
                data: new List<Endpoints> { endpoint1 },
                errors: new List<Error>()
            );

            var apiResponse = new ApiResponse<ListEndpointsResponse>(HttpStatusCode.OK, listResponse);
            mockClient.Setup(x => x.Get<ListEndpointsResponse>("/accounts/{accountId}/endpoints", It.IsAny<RequestOptions>(), fakeConfiguration)).Returns(apiResponse);
            var response = instance.ListEndpointsWithHttpInfo(accountId, status: EndpointStatusEnum.CONNECTED);

            Assert.IsType<ApiResponse<ListEndpointsResponse>>(response);
            Assert.Equal(HttpStatusCode.OK, response.StatusCode);
            Assert.NotNull(response.Data.Data);
            Assert.Single(response.Data.Data);
            Assert.Equal(EndpointStatusEnum.CONNECTED, response.Data.Data[0].Status);
        }

        /// <summary>
        /// Test unauthorized ListEndpoints Request
        /// </summary>
        [Fact]
        public void ListEndpointsUnauthorizedRequest()
        {
            string accountId = "9900000";
            fakeConfiguration.Username = "badUsername";
            fakeConfiguration.Password = "badPassword";

            var apiResponse = new ApiResponse<ListEndpointsResponse>(HttpStatusCode.Unauthorized, null);
            mockClient.Setup(x => x.Get<ListEndpointsResponse>("/accounts/{accountId}/endpoints", It.IsAny<RequestOptions>(), fakeConfiguration)).Returns(apiResponse);
            ApiException Exception = Assert.Throws<ApiException>(() => instance.ListEndpoints(accountId));

            Assert.Equal("Error calling ListEndpoints: ", Exception.Message);
            Assert.Equal(401, Exception.ErrorCode);
        }

        /// <summary>
        /// Test forbidden ListEndpoints Request
        /// </summary>
        [Fact]
        public void ListEndpointsForbiddenRequest()
        {
            string accountId = "9900000";
            fakeConfiguration.Username = "forbiddenUsername";
            fakeConfiguration.Password = "forbiddenPassword";

            var apiResponse = new ApiResponse<ListEndpointsResponse>(HttpStatusCode.Forbidden, null);
            mockClient.Setup(x => x.Get<ListEndpointsResponse>("/accounts/{accountId}/endpoints", It.IsAny<RequestOptions>(), fakeConfiguration)).Returns(apiResponse);
            ApiException Exception = Assert.Throws<ApiException>(() => instance.ListEndpoints(accountId));

            Assert.Equal("Error calling ListEndpoints: ", Exception.Message);
            Assert.Equal(403, Exception.ErrorCode);
        }

        /// <summary>
        /// Test DeleteEndpoint
        /// </summary>
        [Fact]
        public void DeleteEndpointTest()
        {
            string accountId = "9900000";
            string endpointId = "e-15ac29a2-1331029c-2cb0-4a07-b215-b22865662d85";

            var apiResponse = new ApiResponse<Object>(HttpStatusCode.NoContent, null);
            mockClient.Setup(x => x.Delete<Object>("/accounts/{accountId}/endpoints/{endpointId}", It.IsAny<RequestOptions>(), fakeConfiguration)).Returns(apiResponse);
            var response = instance.DeleteEndpointWithHttpInfo(accountId, endpointId);

            Assert.IsType<ApiResponse<Object>>(response);
            Assert.Equal(HttpStatusCode.NoContent, response.StatusCode);
        }

        /// <summary>
        /// Test unauthorized DeleteEndpoint Request
        /// </summary>
        [Fact]
        public void DeleteEndpointUnauthorizedRequest()
        {
            string accountId = "9900000";
            string endpointId = "e-15ac29a2-1331029c-2cb0-4a07-b215-b22865662d85";
            fakeConfiguration.Username = "badUsername";
            fakeConfiguration.Password = "badPassword";

            var apiResponse = new ApiResponse<Object>(HttpStatusCode.Unauthorized, null);
            mockClient.Setup(x => x.Delete<Object>("/accounts/{accountId}/endpoints/{endpointId}", It.IsAny<RequestOptions>(), fakeConfiguration)).Returns(apiResponse);
            ApiException Exception = Assert.Throws<ApiException>(() => instance.DeleteEndpoint(accountId, endpointId));

            Assert.Equal("Error calling DeleteEndpoint: ", Exception.Message);
            Assert.Equal(401, Exception.ErrorCode);
        }

        /// <summary>
        /// Test forbidden DeleteEndpoint Request
        /// </summary>
        [Fact]
        public void DeleteEndpointForbiddenRequest()
        {
            string accountId = "9900000";
            string endpointId = "e-15ac29a2-1331029c-2cb0-4a07-b215-b22865662d85";
            fakeConfiguration.Username = "forbiddenUsername";
            fakeConfiguration.Password = "forbiddenPassword";

            var apiResponse = new ApiResponse<Object>(HttpStatusCode.Forbidden, null);
            mockClient.Setup(x => x.Delete<Object>("/accounts/{accountId}/endpoints/{endpointId}", It.IsAny<RequestOptions>(), fakeConfiguration)).Returns(apiResponse);
            ApiException Exception = Assert.Throws<ApiException>(() => instance.DeleteEndpoint(accountId, endpointId));

            Assert.Equal("Error calling DeleteEndpoint: ", Exception.Message);
            Assert.Equal(403, Exception.ErrorCode);
        }

        /// <summary>
        /// Test not found DeleteEndpoint Request
        /// </summary>
        [Fact]
        public void DeleteEndpointNotFoundRequest()
        {
            string accountId = "9900000";
            string endpointId = "not-a-valid-endpoint-id";

            var apiResponse = new ApiResponse<Object>(HttpStatusCode.NotFound, null);
            mockClient.Setup(x => x.Delete<Object>("/accounts/{accountId}/endpoints/{endpointId}", It.IsAny<RequestOptions>(), fakeConfiguration)).Returns(apiResponse);
            ApiException Exception = Assert.Throws<ApiException>(() => instance.DeleteEndpoint(accountId, endpointId));

            Assert.Equal("Error calling DeleteEndpoint: ", Exception.Message);
            Assert.Equal(404, Exception.ErrorCode);
        }

        /// <summary>
        /// Test UpdateEndpointBxml
        /// </summary>
        [Fact]
        public void UpdateEndpointBxmlTest()
        {
            string accountId = "9900000";
            string endpointId = "e-15ac29a2-1331029c-2cb0-4a07-b215-b22865662d85";
            string bxml = "<?xml version=\"1.0\" encoding=\"UTF-8\"?><Response><SpeakSentence>Hello World</SpeakSentence></Response>";

            var apiResponse = new ApiResponse<Object>(HttpStatusCode.NoContent, null);
            mockClient.Setup(x => x.Put<Object>("/accounts/{accountId}/endpoints/{endpointId}/bxml", It.IsAny<RequestOptions>(), fakeConfiguration)).Returns(apiResponse);
            var response = instance.UpdateEndpointBxmlWithHttpInfo(accountId, endpointId, bxml);

            Assert.IsType<ApiResponse<Object>>(response);
            Assert.Equal(HttpStatusCode.NoContent, response.StatusCode);
        }

        /// <summary>
        /// Test unauthorized UpdateEndpointBxml Request
        /// </summary>
        [Fact]
        public void UpdateEndpointBxmlUnauthorizedRequest()
        {
            string accountId = "9900000";
            string endpointId = "e-15ac29a2-1331029c-2cb0-4a07-b215-b22865662d85";
            string bxml = "<?xml version=\"1.0\" encoding=\"UTF-8\"?><Response><SpeakSentence>Hello World</SpeakSentence></Response>";
            fakeConfiguration.Username = "badUsername";
            fakeConfiguration.Password = "badPassword";

            var apiResponse = new ApiResponse<Object>(HttpStatusCode.Unauthorized, null);
            mockClient.Setup(x => x.Put<Object>("/accounts/{accountId}/endpoints/{endpointId}/bxml", It.IsAny<RequestOptions>(), fakeConfiguration)).Returns(apiResponse);
            ApiException Exception = Assert.Throws<ApiException>(() => instance.UpdateEndpointBxml(accountId, endpointId, bxml));

            Assert.Equal("Error calling UpdateEndpointBxml: ", Exception.Message);
            Assert.Equal(401, Exception.ErrorCode);
        }

        /// <summary>
        /// Test forbidden UpdateEndpointBxml Request
        /// </summary>
        [Fact]
        public void UpdateEndpointBxmlForbiddenRequest()
        {
            string accountId = "9900000";
            string endpointId = "e-15ac29a2-1331029c-2cb0-4a07-b215-b22865662d85";
            string bxml = "<?xml version=\"1.0\" encoding=\"UTF-8\"?><Response><SpeakSentence>Hello World</SpeakSentence></Response>";
            fakeConfiguration.Username = "forbiddenUsername";
            fakeConfiguration.Password = "forbiddenPassword";

            var apiResponse = new ApiResponse<Object>(HttpStatusCode.Forbidden, null);
            mockClient.Setup(x => x.Put<Object>("/accounts/{accountId}/endpoints/{endpointId}/bxml", It.IsAny<RequestOptions>(), fakeConfiguration)).Returns(apiResponse);
            ApiException Exception = Assert.Throws<ApiException>(() => instance.UpdateEndpointBxml(accountId, endpointId, bxml));

            Assert.Equal("Error calling UpdateEndpointBxml: ", Exception.Message);
            Assert.Equal(403, Exception.ErrorCode);
        }

        /// <summary>
        /// Test not found UpdateEndpointBxml Request
        /// </summary>
        [Fact]
        public void UpdateEndpointBxmlNotFoundRequest()
        {
            string accountId = "9900000";
            string endpointId = "not-a-valid-endpoint-id";
            string bxml = "<?xml version=\"1.0\" encoding=\"UTF-8\"?><Response><SpeakSentence>Hello World</SpeakSentence></Response>";

            var apiResponse = new ApiResponse<Object>(HttpStatusCode.NotFound, null);
            mockClient.Setup(x => x.Put<Object>("/accounts/{accountId}/endpoints/{endpointId}/bxml", It.IsAny<RequestOptions>(), fakeConfiguration)).Returns(apiResponse);
            ApiException Exception = Assert.Throws<ApiException>(() => instance.UpdateEndpointBxml(accountId, endpointId, bxml));

            Assert.Equal("Error calling UpdateEndpointBxml: ", Exception.Message);
            Assert.Equal(404, Exception.ErrorCode);
        }

        /// <summary>
        /// Test bad request UpdateEndpointBxml with invalid BXML
        /// </summary>
        [Fact]
        public void UpdateEndpointBxmlBadRequest()
        {
            string accountId = "9900000";
            string endpointId = "e-15ac29a2-1331029c-2cb0-4a07-b215-b22865662d85";
            string bxml = "invalid xml";

            var apiResponse = new ApiResponse<Object>(HttpStatusCode.BadRequest, null);
            mockClient.Setup(x => x.Put<Object>("/accounts/{accountId}/endpoints/{endpointId}/bxml", It.IsAny<RequestOptions>(), fakeConfiguration)).Returns(apiResponse);
            ApiException Exception = Assert.Throws<ApiException>(() => instance.UpdateEndpointBxml(accountId, endpointId, bxml));

            Assert.Equal("Error calling UpdateEndpointBxml: ", Exception.Message);
            Assert.Equal(400, Exception.ErrorCode);
        }
    }
}
