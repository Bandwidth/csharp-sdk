using System;
using System.Net;
using System.Collections.Generic;
using Xunit;

using Bandwidth.Standard.Client;
using Bandwidth.Standard.Api;
using Bandwidth.Standard.Model;

namespace Bandwidth.Standard.Test.Smoke
{
    /// <summary>
    ///  Class for testing MultiChannelApi
    /// </summary>
    /// <remarks>
    /// This file is automatically generated by OpenAPI Generator (https://openapi-generator.tech).
    /// Please update the test case below to test the API endpoint.
    /// </remarks>
    public class MultiChannelSmokeTests : IDisposable
    {
        private MultiChannelApi instance;
        private string accountId;
        private Configuration configuration;
        private string bwNumber;
        private string messagingApplicationId;

        public MultiChannelSmokeTests()
        {
            accountId = Environment.GetEnvironmentVariable("BW_ACCOUNT_ID");
            bwNumber = Environment.GetEnvironmentVariable("BW_NUMBER");
            messagingApplicationId = Environment.GetEnvironmentVariable("BW_MESSAGING_APPLICATION_ID");

            // Authorized API Client
            configuration = new Configuration();
            configuration.Username = Environment.GetEnvironmentVariable("BW_USERNAME");
            configuration.Password = Environment.GetEnvironmentVariable("BW_PASSWORD");
            instance = new MultiChannelApi(configuration);
        }

        public void Dispose()
        {
            // Cleanup when everything is done.
        }

        /// <summary>
        /// Test an instance of MultiChannelApi
        /// </summary>
        [Fact]
        public void InstanceTest()
        {
            Assert.IsType<MultiChannelApi>(instance);
        }

        /// <summary>
        /// Test CreateMultiChannelSMSMessage
        /// </summary>
        [Fact]
        public void CreateMultiChannelSMSMessageTest()
        {
            MultiChannelChannelListRequestObject channelListObject = new MultiChannelChannelListRequestObject(
                new MultiChannelChannelListSMSObject(
                    from: bwNumber,
                    applicationId: messagingApplicationId,
                    channel: MultiChannelMessageChannelEnum.SMS,
                    content: new SmsMessageContent(text: "Hello World!")
                )
            );

            MultiChannelMessageRequest multiChannelMessageRequest = new MultiChannelMessageRequest(
                to: Environment.GetEnvironmentVariable("USER_NUMBER"),
                tag: "tag",
                priority: PriorityEnum.High,
                expiration: DateTime.UtcNow.AddMinutes(1),
                channelList: new List<MultiChannelChannelListRequestObject> { channelListObject }
            );

            var response = instance.CreateMultiChannelMessageWithHttpInfo(accountId, multiChannelMessageRequest);
            Assert.IsType<ApiResponse<CreateMultiChannelMessageResponse>>(response);
            Assert.Equal(HttpStatusCode.Accepted, response.StatusCode);
            Assert.NotNull(response.Data);
            Assert.IsType<CreateMultiChannelMessageResponse>(response.Data);
            Assert.IsType<List<Link>>(response.Data.Links);
            Assert.IsType<MultiChannelMessageResponseData>(response.Data.Data);
            Assert.IsType<String>(response.Data.Data.Id);
            Assert.IsType<DateTime>(response.Data.Data.Time);
            Assert.IsType<MessageDirectionEnum>(response.Data.Data.Direction);
            Assert.Equal(response.Data.Data.Direction, MessageDirectionEnum.Out);
            Assert.IsType<List<String>>(response.Data.Data.To);
            Assert.IsType<String>(response.Data.Data.Tag);
            Assert.IsType<PriorityEnum>(response.Data.Data.Priority);
            Assert.Equal(response.Data.Data.Priority, PriorityEnum.High);
            Assert.IsType<DateTime>(response.Data.Data.Expiration);
            Assert.IsType<List<MultiChannelChannelListResponseObject>>(response.Data.Data.ChannelList);

            // Add more assertions when C# generator supports discriminator mapping
            // Assert.IsType<MultiChannelChannelListSMSResponseObject>(response.Data.Data.ChannelList[0].ActualInstance);
        }

        /// <summary>
        /// Test CreateMultiChannelMMSMessage
        /// </summary>
        [Fact]
        public void CreateMultiChannelMMSMessageTest()
        {
            MultiChannelChannelListRequestObject channelListObject = new MultiChannelChannelListRequestObject(
                new MultiChannelChannelListMMSObject(
                    from: bwNumber,
                    applicationId: messagingApplicationId,
                    channel: MultiChannelMessageChannelEnum.MMS,
                    content: new MmsMessageContent(
                        text: "Hello World!",
                        media: new List<MmsMessageContentFile> {
                            new MmsMessageContentFile(
                                fileUrl: "https://www.example.com/image.jpg"
                            )
                        }
                    )
                )
            );

            MultiChannelMessageRequest multiChannelMessageRequest = new MultiChannelMessageRequest(
                to: Environment.GetEnvironmentVariable("USER_NUMBER"),
                tag: "tag",
                priority: PriorityEnum.High,
                expiration: DateTime.UtcNow.AddMinutes(1),
                channelList: new List<MultiChannelChannelListRequestObject> { channelListObject }
            );

            var response = instance.CreateMultiChannelMessageWithHttpInfo(accountId, multiChannelMessageRequest);
            Assert.IsType<ApiResponse<CreateMultiChannelMessageResponse>>(response);
            Assert.Equal(HttpStatusCode.Accepted, response.StatusCode);
            Assert.NotNull(response.Data);
            Assert.IsType<CreateMultiChannelMessageResponse>(response.Data);
            Assert.IsType<List<Link>>(response.Data.Links);
            Assert.IsType<MultiChannelMessageResponseData>(response.Data.Data);
            Assert.IsType<String>(response.Data.Data.Id);
            Assert.IsType<DateTime>(response.Data.Data.Time);
            Assert.IsType<MessageDirectionEnum>(response.Data.Data.Direction);
            Assert.Equal(response.Data.Data.Direction, MessageDirectionEnum.Out);
            Assert.IsType<List<String>>(response.Data.Data.To);
            Assert.IsType<String>(response.Data.Data.Tag);
            Assert.IsType<PriorityEnum>(response.Data.Data.Priority);
            Assert.Equal(response.Data.Data.Priority, PriorityEnum.High);
            Assert.IsType<DateTime>(response.Data.Data.Expiration);
            Assert.IsType<List<MultiChannelChannelListResponseObject>>(response.Data.Data.ChannelList);

            // Add more assertions when C# generator supports discriminator mapping
            // Assert.IsType<MultiChannelChannelListMMSResponseObject>(response.Data.Data.ChannelList[0].ActualInstance);
        }

        /// <summary>
        /// Test CreateMultiChannelRBMMessage
        /// </summary>
        [Fact]
        public void CreateMultiChannelRBMMessageTest()
        {
            MultiChannelChannelListRequestObject channelListObject = new MultiChannelChannelListRequestObject(
                new MultiChannelChannelListRBMObject(
                    from: bwNumber,
                    applicationId: messagingApplicationId,
                    channel: MultiChannelMessageChannelEnum.RBM,
                    content: new MultiChannelChannelListRBMObjectAllOfContent(
                        new RbmMessageContentText(
                            text: "Hello World!",
                            suggestions: new List<MultiChannelAction> {
                                new MultiChannelAction(new RbmActionDial(
                                    type: RbmActionTypeEnum.DIALPHONE,
                                    text: "Call Us",
                                    postbackData: new byte[]{1, 2, 3},
                                    phoneNumber: bwNumber
                                ))
                            }
                        )
                    )
                )
            );

            MultiChannelMessageRequest multiChannelMessageRequest = new MultiChannelMessageRequest(
                to: Environment.GetEnvironmentVariable("USER_NUMBER"),
                tag: "tag",
                priority: PriorityEnum.High,
                expiration: DateTime.UtcNow.AddMinutes(1),
                channelList: new List<MultiChannelChannelListRequestObject> { channelListObject }
            );

            var response = instance.CreateMultiChannelMessageWithHttpInfo(accountId, multiChannelMessageRequest);
            Assert.IsType<ApiResponse<CreateMultiChannelMessageResponse>>(response);
            Assert.Equal(HttpStatusCode.Accepted, response.StatusCode);
            Assert.NotNull(response.Data);
            Assert.IsType<CreateMultiChannelMessageResponse>(response.Data);
            Assert.IsType<List<Link>>(response.Data.Links);
            Assert.IsType<MultiChannelMessageResponseData>(response.Data.Data);
            Assert.IsType<String>(response.Data.Data.Id);
            Assert.IsType<DateTime>(response.Data.Data.Time);
            Assert.IsType<MessageDirectionEnum>(response.Data.Data.Direction);
            Assert.Equal(response.Data.Data.Direction, MessageDirectionEnum.Out);
            Assert.IsType<List<String>>(response.Data.Data.To);
            Assert.IsType<String>(response.Data.Data.Tag);
            Assert.IsType<PriorityEnum>(response.Data.Data.Priority);
            Assert.Equal(response.Data.Data.Priority, PriorityEnum.High);
            Assert.IsType<DateTime>(response.Data.Data.Expiration);
            Assert.IsType<List<MultiChannelChannelListResponseObject>>(response.Data.Data.ChannelList);

            // Add more assertions when C# generator supports discriminator mapping
            // Assert.IsType<MultiChannelChannelListSMSResponseObject>(response.Data.Data.ChannelList[0].ActualInstance);
        }
    }
}
