/*
 * Bandwidth
 *
 * Bandwidth's Communication APIs
 *
 * The version of the OpenAPI document: 1.0.0
 * Contact: letstalk@bandwidth.com
 * Generated by: https://github.com/openapitools/openapi-generator.git
 */

using System;
using Xunit;

using Bandwidth.Standard.Client;
using Bandwidth.Standard.Api;
using Bandwidth.Standard.Model;
using System.Net;

namespace Bandwidth.Standard.Test.Smoke
{
    /// <summary>
    ///  Class for testing StatisticsApi
    /// </summary>
    public class StatisticsSmokeTests : IDisposable
    {
        private string accountId;
        private Configuration configuration;
        private StatisticsApi forbiddenInstance;
        private StatisticsApi instance;
        private StatisticsApi unauthorizedInstance;

        public StatisticsSmokeTests()
        {
            accountId = Environment.GetEnvironmentVariable("BW_ACCOUNT_ID");

            // Authorized API Client
            configuration = new Configuration();
            configuration.BasePath = "https://voice.bandwidth.com/api/v2";
            configuration.OAuthClientId = Environment.GetEnvironmentVariable("BW_CLIENT_ID");
            configuration.OAuthClientSecret = Environment.GetEnvironmentVariable("BW_CLIENT_SECRET");
            instance = new StatisticsApi(configuration);

            // Unauthorized API Client
            configuration.Username = "badUsername";
            configuration.Password = "badPassword";
            unauthorizedInstance = new StatisticsApi(configuration);

            // Forbidden API Client
            configuration.Username = Environment.GetEnvironmentVariable("BW_USERNAME_FORBIDDEN");
            configuration.Password = Environment.GetEnvironmentVariable("BW_PASSWORD_FORBIDDEN");
            forbiddenInstance = new StatisticsApi(configuration);
        }

        public void Dispose()
        {
            // Cleanup when everything is done.
        }

        /// <summary>
        /// Test an instance of StatisticsApi
        /// </summary>
        [Fact]
        public void InstanceTest()
        {
            Assert.IsType<StatisticsApi>(instance);
        }

        /// <summary>
        /// Test successful GetStatistics
        /// </summary>
        [Fact]
        public void GetStatisticsTest()
        {
            var response = instance.GetStatisticsWithHttpInfo(accountId);
            Assert.IsType<ApiResponse<AccountStatistics>>(response);
            Assert.Equal(HttpStatusCode.OK, response.StatusCode);
        }

        /// <summary>
        /// Tests GetStatistics with an unauthorized client
        /// </summary>
        [Fact]
        public void GetStatisticsUnauthorizedRequest()
        {
            ApiException exception = Assert.Throws<ApiException>(() => unauthorizedInstance.GetStatisticsWithHttpInfo(accountId));
            Assert.Equal(401, exception.ErrorCode);
        }

        /// <summary>
        /// Tests GetStatistics with a forbidden client
        /// </summary>
        [Fact]
        public void GetStatisticsForbiddenRequest()
        {
            ApiException exception = Assert.Throws<ApiException>(() => forbiddenInstance.GetStatisticsWithHttpInfo(accountId));
            Assert.Equal(403, exception.ErrorCode);
        }
    }
}
